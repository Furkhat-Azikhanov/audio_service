
# üéß Audio Service

FastAPI-—Å–µ—Ä–≤–∏—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å. –•—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ JWT-—Ç–æ–∫–µ–Ω—ã. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚Äî PostgreSQL 16, —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Docker.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å OAuth
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ access_token (JWT)
- –ü–æ–ª—É—á–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–≤ —Ç–æ–º —á–∏—Å–ª–µ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º)
- –ó–∞–≥—Ä—É–∑–∫–∞ –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤ (mp3, wav, ogg)
- –•—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üß± –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **FastAPI** (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
- **PostgreSQL 16**
- **SQLAlchemy 2.0 + asyncpg**
- **Docker + docker-compose**
- **JWT-—Ç–æ–∫–µ–Ω—ã (python-jose)**
- **OAuth —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å**

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
```bash
git clone https://github.com/–¢–í–û–ô_–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨/audio_service.git
cd audio_service
```

### 2. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `.env`
‚ùó –ù–∞—Å—Ç–æ—è—â–∏–π `.env` –Ω–µ –ø—É—à–∏—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, —Å–æ–∑–¥–∞–π —Å–∞–º —Ä—è–¥–æ–º —Å `docker-compose.yml`

```
POSTGRES_DB=audio_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=secret
DATABASE_URL=postgresql+asyncpg://postgres:secret@db:5432/audio_db
JWT_SECRET=supersecret
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
YANDEX_OAUTH_CLIENT_ID=—Ç–≤–æ—è_–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
YANDEX_OAUTH_CLIENT_SECRET=—Ç–≤–æ–π_—Å–µ–∫—Ä–µ—Ç
YANDEX_OAUTH_REDIRECT_URI=http://localhost:8000/auth/yandex/callback
```
‚ö†Ô∏è –¢–∞–∫–∂–µ –º–æ–∂–µ—à—å –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å `.env.example` –¥–ª—è –ø–æ–¥—Å–∫–∞–∑–∫–∏.

### 3. –°–æ–±–µ—Ä–∏ –∏ –∑–∞–ø—É—Å—Ç–∏ —á–µ—Ä–µ–∑ Docker
```bash
docker-compose up --build
```

### 4. –û—Ç–∫—Ä–æ–π –±—Ä–∞—É–∑–µ—Ä
```
http://localhost:8000/docs
```

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
.
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ database.py
‚îÇ   ‚îú‚îÄ‚îÄ models.py
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ token.py
‚îÇ   ‚îú‚îÄ‚îÄ routers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ audio.py
‚îÇ   ‚îî‚îÄ‚îÄ audio_files/  # –ª–æ–∫–∞–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ .env.example
‚îî‚îÄ‚îÄ README.md
```

## üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å
1. –ü–µ—Ä–µ–π–¥–∏ –ø–æ `/auth/yandex/login`
2. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Å—è —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å
3. –ü–æ–ª—É—á–∏—à—å —Ç–æ–∫–µ–Ω `access_token`
4. –ò—Å–ø–æ–ª—å–∑—É–π –µ–≥–æ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ:
```
Authorization: Bearer eyJhbGciOi...
```

## üß™ –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞:
```bash
curl -X POST "http://localhost:8000/audio/upload?name=–ø–µ—Å–Ω—è" \
  -H "Authorization: Bearer <your_token>" \
  -F "file=@/–ø—É—Ç—å/–∫/—Ñ–∞–π–ª—É.mp3;type=audio/mpeg"
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞:
```bash
curl -H "Authorization: Bearer <your_token>" http://localhost:8000/audio/
```

## üõ†Ô∏è TODO
* –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å
* –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT —Ç–æ–∫–µ–Ω–∞
* –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
* –ó–∞–≥—Ä—É–∑–∫–∞ –∞—É–¥–∏–æ
* –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤
* –¢–µ—Å—Ç—ã (–ø–æ –∂–µ–ª–∞–Ω–∏—é)
* CI/CD (–ø–æ –∂–µ–ª–∞–Ω–∏—é)

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä
–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è Furkhat Azikhanov